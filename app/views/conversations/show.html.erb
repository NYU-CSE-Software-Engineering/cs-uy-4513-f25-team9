<div class="seller-home-container">
  <div class="seller-home-header">
    <div>
      <h1>Conversation</h1>
      <p class="header-subtitle">
        About: <%= link_to @conversation.listing.title, @conversation.listing, class: "listing-link" %>
      </p>
    </div>
    <div>
      <%= link_to conversations_path, class: "btn btn-primary" do %>
        <svg class="btn-icon-sm" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path fill-rule="evenodd" d="M11.03 3.97a.75.75 0 010 1.06l-6.22 6.22H21a.75.75 0 010 1.5H4.81l6.22 6.22a.75.75 0 11-1.06 1.06l-7.5-7.5a.75.75 0 010-1.06l7.5-7.5a.75.75 0 011.06 0z" clip-rule="evenodd" />
        </svg>
        <span>Back to Messages</span>
      <% end %>
    </div>
  </div>

  <div class="conversation-info">
    <div class="info-card">
      <h3>Conversation Details</h3>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Listing:</span>
          <span class="info-value"><%= link_to @conversation.listing.title, @conversation.listing, class: "info-link" %></span>
        </div>
        <div class="info-item">
          <span class="info-label">Price:</span>
          <span class="info-value"><%= number_to_currency(@conversation.listing.price) %></span>
        </div>
        <div class="info-item">
          <span class="info-label">Buyer:</span>
          <span class="info-value"><%= @conversation.buyer.email %></span>
        </div>
        <div class="info-item">
          <span class="info-label">Seller:</span>
          <span class="info-value"><%= @conversation.seller.email %></span>
        </div>
      </div>
    </div>
  </div>

  <div class="chat-container">
    <div class="messages-header">
      <h2>Messages</h2>
    </div>

    <div class="messages-list" id="messages">
      <% if @conversation.messages.empty? %>
        <div class="empty-chat">
          <p>No messages yet. Start the conversation!</p>
        </div>
      <% else %>
        <% @conversation.messages.each do |message| %>
          <div class="message <%= message.user == current_user ? 'message-sent' : 'message-received' %>">
            <div class="message-header">
              <span class="message-sender"><%= message.user.email %></span>
              <span class="message-time"><%= message.created_at.strftime("%b %d, %I:%M %p") if message.created_at %></span>
            </div>
            <div class="message-content">
              <%= message.content %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="message-form">
      <%= form_with model: [@conversation, Message.new], local: true, class: "message-form-inner" do |form| %>
        <div class="form-group">
          <%= form.label :content, "Your message:", class: "form-label" %>
          <%= form.text_area :content, rows: 3, class: "form-textarea", placeholder: "Type your message here..." %>
        </div>
        <div class="form-actions">
          <%= form.submit "Send Message", class: "btn btn-primary" %>
        </div>
      <% end %>
    </div>
  </div>
</div>