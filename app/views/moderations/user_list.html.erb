<div class="user-list-container">
  <div class="page-header">
    <h1>User List</h1>
    <p class="page-subtitle">Manage users and moderation privileges</p>
  </div>

  <% if @users.empty? %>
    <div class="empty-message">
      <p>No users found.</p>
    </div>
  <% else %>
    <div class="table-container">
      <table class="users-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Email</th>
            <th>User Type</th>
            <th>Number of Reports</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% @users.each do |user| %>
            <tr class="user-row">
              <td class="user-id">#<%= user.id %></td>
              <td class="user-name"><%= user.name.present? ? user.name : "N/A" %></td>
              <td class="user-email"><%= user.email %></td>
              <td class="user-type">
                <% if user.admin? %>
                  <span class="badge badge-admin">Admin</span>
                <% elsif user.moderator? %>
                  <span class="badge badge-moderator">Moderator</span>
                <% else %>
                  <span class="badge badge-user">User</span>
                <% end %>
              </td>
              <td class="user-reports">
                <span class="report-count <%= user.reported_listings_count == 0 ? 'no-reports' : '' %>">
                  <%= user.reported_listings_count %>
                </span>
              </td>
              <td class="user-actions">
                <div class="actions-wrapper">
                  <% if user.admin? %>
                    <%= button_to "Delete User", "#", 
                        method: :delete, 
                        class: "btn-delete",
                        disabled: true,
                        title: "Admin users cannot be deleted" %>
                  <% else %>
                    <%= button_to "Delete User", moderations_user_path(user), 
                        method: :delete, 
                        class: "btn-delete",
                        data: { turbo_confirm: "Are you sure you want to delete this user? This action cannot be undone." } %>
                  <% end %>
                  <% if current_user.admin? && user.moderator? && !user.admin? %>
                    <%= button_to "Remove Privileges", remove_moderator_path(user), 
                        method: :patch, 
                        class: "btn-remove-privileges",
                        data: { turbo_confirm: "Are you sure you want to remove moderation privileges from #{user.name || user.email}?" } %>
                  <% end %>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% end %>
</div>
